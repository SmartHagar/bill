(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[445],{6922:function(a,e,t){Promise.resolve().then(t.bind(t,5269))},1590:function(a){(()=>{"use strict";var e={d:(a,t)=>{for(var r in t)e.o(t,r)&&!e.o(a,r)&&Object.defineProperty(a,r,{enumerable:!0,get:t[r]})},o:(a,e)=>Object.prototype.hasOwnProperty.call(a,e),r:a=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>n});var r=function(){var a;function e(){!function(a,e){if(!(a instanceof e))throw TypeError("Cannot call a class as a function")}(this,e)}return a=[{key:"changeHeightWidth",value:function(a,e,t,r,n,i){return t>r&&(a=Math.round(a*r/t),t=r),a>e&&(t=Math.round(t*e/a),a=e),n&&t<n&&(a=Math.round(a*n/t),t=n),i&&a<i&&(t=Math.round(t*i/a),a=i),{height:a,width:t}}},{key:"resizeAndRotateImage",value:function(a,e,t,r,n){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,o=document.createElement("canvas"),d=a.width,u=a.height,c=this.changeHeightWidth(u,t,d,e,r,n);l&&(90===l||270===l)?(o.width=c.height,o.height=c.width):(o.width=c.width,o.height=c.height),d=c.width,u=c.height;var h=o.getContext("2d");return h.fillStyle="rgba(0, 0, 0, 0)",h.fillRect(0,0,d,u),h.imageSmoothingEnabled&&h.imageSmoothingQuality&&(h.imageSmoothingQuality="high"),l&&(h.rotate(l*Math.PI/180),90===l?h.translate(0,-o.width):180===l?h.translate(-o.width,-o.height):270===l?h.translate(-o.height,0):0!==l&&360!==l||h.translate(0,0)),h.drawImage(a,0,0,d,u),o.toDataURL("image/".concat(i),s/100)}},{key:"b64toByteArrays",value:function(a,e){e=e||"image/jpeg";for(var t=atob(a.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),r=[],n=0;n<t.length;n+=512){for(var i=t.slice(n,n+512),s=Array(i.length),l=0;l<i.length;l++)s[l]=i.charCodeAt(l);var o=new Uint8Array(s);r.push(o)}return r}},{key:"b64toBlob",value:function(a,e){var t=this.b64toByteArrays(a,e);return new Blob(t,{type:e,lastModified:new Date})}},{key:"b64toFile",value:function(a,e,t){var r=this.b64toByteArrays(a,t);return new File(r,e,{type:t,lastModified:new Date})}},{key:"createResizedImage",value:function(a,t,r,n,i,s,l){var o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=new FileReader;if(!a)throw Error("File Not Found!");if(a.type&&!a.type.includes("image"))throw Error("File Is NOT Image!");c.readAsDataURL(a),c.onload=function(){var h=new Image;h.src=c.result,h.onload=function(){var c=e.resizeAndRotateImage(h,t,r,d,u,n,i,s),g="image/".concat(n);switch(o){case"blob":l(e.b64toBlob(c,g));break;case"base64":default:l(c);break;case"file":var b=a.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(n.toString());l(e.b64toFile(c,b,g))}}},c.onerror=function(a){throw Error(a)}}}],function(a,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}(e,a),e}();let n={imageFileResizer:function(a,e,t,n,i,s,l,o,d,u){return r.createResizedImage(a,e,t,n,i,s,l,o,d,u)}};a.exports=t})()},5269:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return x}});var r=t(7437),n=t(2265),i=t(3379),s=t(5676),l=t(8470),o=t(4901),d=a=>{let{setDelete:e,setEdit:t,search:d,anggota_id:u,setTambah:c}=a,{setPembayaran:h,dtPembayaran:g}=(0,o.Z)(),[b,m]=(0,n.useState)(1),[y,p]=(0,n.useState)(10),[f,v]=(0,n.useState)(!0),w=(0,n.useCallback)(async()=>{u&&(v(!0),await h({page:b,limit:y,search:d,anggota_id:u}),v(!1))},[h,b,y,d,u]);return(0,n.useEffect)(()=>{m(1),w()},[d,w]),(0,n.useEffect)(()=>(w(),()=>{}),[b,y,w]),(0,r.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:f?(0,r.jsx)(i.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)(l.Z,{headTable:["No","Tgl. Angsuran","Status","Bukti Pembayaran"],tableBodies:["tgl_bayar","status_bayar","bukti_bayar"],dataTable:g.data,page:b,limit:y,setEdit:t,setDelete:e,ubah:!0,hapus:!1})}),(null==g?void 0:g.last_page)>1&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(s.Z,{currentPage:null==g?void 0:g.current_page,totalPages:null==g?void 0:g.last_page,setPage:m})})]})})},u=t(8224),c=t(6628),h=t(8658),g=t(2670),b=t(2820);t(2413);var m=a=>{let{register:e,errors:t,control:n,dtEdit:i,watch:s,setValue:l,showModal:o,myFile:d,setMyFile:u}=a;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(b.Z,{label:"Bukti Pembayaran",name:"bukti_bayar",register:e,accept:"image/*",required:!0,errors:t.bukti_bayar,addClass:"col-span-4",setValue:l,fileEdit:null==i?void 0:i.bukti_bayar,myFile:d,setMyFile:u})})},y=t(1262),p=t(1023),f=a=>{let{showModal:e,setShowModal:t,dtEdit:s}=a,[l,d]=(0,n.useState)(),[b,f]=(0,n.useState)(!1),{addData:v,updateData:w}=(0,o.Z)(),{register:_,handleSubmit:j,setValue:x,control:S,formState:{errors:k},watch:P}=(0,g.cI)(),Z=()=>{x("id",""),x("terima_pinjam_id",""),x("bukti_bayar",""),d(null)};(0,n.useEffect)(()=>{s?(x("id",s.id),x("terima_pinjam_id",s.terima_pinjam_id),x("bukti_bayar",""),x("tgl_bayar",s.tgl_bayar),x("status_bayar",s.status_bayar),d(s.bukti_bayar)):Z()},[e,s]);let F=async a=>{a.status_bayar="proses",console.log({row:a}),(0,p.Z)({row:a,dtEdit:s,setIsLoading:f,setShowModal:t,addData:v,updateData:w,resetForm:Z,toastShow:h.Z})};return(0,r.jsx)(c.Z,{title:"Form Angsuran",showModal:e,setShowModal:t,children:(0,r.jsxs)("form",{onSubmit:j(F),children:[(0,r.jsx)(u.Z,{name:"id",register:_,type:"hidden"}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,r.jsx)(m,{register:_,errors:k,dtEdit:s,control:S,watch:P,setValue:x,showModal:e,myFile:l,setMyFile:d})}),(0,r.jsx)("div",{children:b?(0,r.jsx)(i.Z,{}):(0,r.jsx)(y.Z,{onClick:j(F),children:"Simpan"})})]})})},v=t(6533),w=t(8009),_=t(7500),j=t(146),x=()=>{let{removeData:a}=(0,o.Z)(),[e,t]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[l,u]=(0,n.useState)(),[c,g]=(0,n.useState)(),[b,m]=(0,n.useState)(""),[p,x]=(0,n.useState)(!1),[S,k]=(0,n.useState)({}),P=j.Z.get("anggota");(0,n.useEffect)(()=>{P&&k(JSON.parse(P))},[P]);let Z=async e=>{let{id:t,isDelete:r}=e;if(u(t),r){let{data:e}=await a(l);(0,h.Z)({event:e}),s(!1)}else s(!0)};return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(w.x7,{}),(0,r.jsx)(f,{dtEdit:c,showModal:e,setShowModal:t}),(0,r.jsx)(v.Z,{showDel:i,setShowDel:s,setDelete:Z}),(0,r.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,r.jsx)("p",{children:"Silahkan Mengolah data Pembayaran"}),p&&(0,r.jsx)("div",{children:(0,r.jsx)(y.Z,{onClick:()=>{t(!0),g(null)},children:"Tambah Data"})})]}),(0,r.jsx)(_.Z,{placeholder:"Cari Data",onChange:a=>m(a)})]}),(0,r.jsx)(d,{setDelete:Z,setEdit:a=>{t(!0),g(a)},search:b,anggota_id:S.id,setTambah:x})]})}},2820:function(a,e,t){"use strict";var r=t(7437),n=t(2153),i=t(703),s=t(2265),l=t(1590),o=t.n(l);e.Z=a=>{let{label:e,register:t,required:l,name:d,errors:u,addClass:c,accept:h,setValue:g,fileEdit:b,myFile:m,setMyFile:y}=a,[p,f]=(0,s.useState)(),v=a=>new Promise(()=>{if(a){var e;let t=(null==a?void 0:null===(e=a.type)||void 0===e?void 0:e.split("/"))||[];if("image"!==t[0])return w(a);console.log({splitType:t}),o().imageFileResizer(a,1500,1500,t[1],80,0,a=>{w(a)},"file")}else w(null)}),w=a=>{var e;if(a){let e=new FileReader;e.readAsDataURL(a),e.onloadend=()=>{y(e.result)}}f(((null==a?void 0:null===(e=a.type)||void 0===e?void 0:e.split("/"))||[])[0]),g(d,a)};return(0,r.jsxs)("div",{className:c,children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:e}),l&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,r.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:h,onChange:a=>{var e;v((null===(e=a.target)||void 0===e?void 0:e.files[0])||null)}}),(0,r.jsx)("input",{type:"hidden",id:e,...t(d,{required:l})}),(0,r.jsxs)("div",{className:"flex gap-4 mt-2",children:[m&&"image"===p&&(0,r.jsx)(i.default,{className:"rounded-lg",src:m,width:100,height:100,alt:""}),b&&"file"!==d&&(0,r.jsx)("div",{children:(0,r.jsx)(i.default,{src:"".concat(n._n,"/").concat(b),width:100,height:100,alt:""})})]}),(null==u?void 0:u.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[e," tidak boleh kosong"]})]})}},4901:function(a,e,t){"use strict";var r=t(2020),n=t(5249),i=t(2153),s=t(4782);let l=(0,r.Ue)((0,n.mW)((a,e)=>({setFormData:a=>{let e=new FormData;return e.append("terima_pinjam_id",a.terima_pinjam_id),e.append("tgl_bayar",a.tgl_bayar),e.append("bukti_bayar",a.bukti_bayar),e.append("status_bayar",a.status_bayar),e.append("bukti_bayar",a.bukti_bayar),e},dtPembayaran:[],showPembayaran:[],setPembayaran:async e=>{let{page:t=1,limit:r=10,search:n,sortby:l,order:o,anggota_id:d,status_pinjam:u="lunas",status_bayar:c}=e;try{let e=await s.Z.getState().setToken(),h=await (0,i.Sj)({method:"get",url:"/pembayaran",headers:{Authorization:"Bearer ".concat(e)},params:{limit:r,page:t,search:n,sortby:l,order:o,anggota_id:d,status_pinjam:u,status_bayar:c}});return a(a=>({...a,dtPembayaran:h.data.data})),{status:"berhasil",data:h.data}}catch(a){var h;return{status:"error",error:null===(h=a.response)||void 0===h?void 0:h.data}}},setShowPembayaran:async e=>{try{let t=await s.Z.getState().setToken(),r=await (0,i.Sj)({method:"get",url:"/pembayaran/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return console.log({response:r}),a(a=>({...a,showPembayaran:r.data.data})),{status:"berhasil",data:r.data}}catch(a){var t;return{status:"error",error:null===(t=a.response)||void 0===t?void 0:t.data}}},addData:async t=>{let r=(null==t?void 0:t.bukti_bayar)?e().setFormData(t):t;try{let e=await s.Z.getState().setToken(),t=await (0,i.Sj)({method:"post",url:"/pembayaran",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"},data:r});return a(a=>({dtPembayaran:{last_page:a.dtPembayaran.last_page,current_page:a.dtPembayaran.current_page,data:[t.data.data,...a.dtPembayaran.data]}})),{status:"berhasil tambah",data:t.data}}catch(a){return{status:"error",data:a.response.data}}},removeData:async e=>{try{let t=await s.Z.getState().setToken(),r=await (0,i.Sj)({method:"delete",url:"/pembayaran/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return a(a=>({dtPembayaran:{last_page:a.dtPembayaran.last_page,current_page:a.dtPembayaran.current_page,data:a.dtPembayaran.data.filter(a=>a.id!==e)}})),{status:"berhasil hapus",data:r.data}}catch(a){return{status:"error",data:a.response.data}}},updateData:async(t,r)=>{delete r.id;let n=(null==r?void 0:r.bukti_bayar)?e().setFormData(r):r,l=await s.Z.getState().setToken();try{let e=await (0,i.Sj)({url:"/pembayaran/".concat(t),method:"post",headers:(null==r?void 0:r.bukti_bayar)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(l)}:{Authorization:"Bearer ".concat(l)},data:n,params:{_method:"PUT"}});return a(a=>({dtPembayaran:{last_page:a.dtPembayaran.last_page,current_page:a.dtPembayaran.current_page,data:a.dtPembayaran.data.map(a=>a.id===t?{...a,...e.data.data}:a)}})),{status:"berhasil update",data:e.data}}catch(a){return{status:"error",data:a.response.data}}}})));e.Z=l}},function(a){a.O(0,[779,990,910,656,703,680,973,971,69,744],function(){return a(a.s=6922)}),_N_E=a.O()}]);