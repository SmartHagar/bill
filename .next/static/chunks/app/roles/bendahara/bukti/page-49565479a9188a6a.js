(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[347],{9862:function(a,e,t){Promise.resolve().then(t.bind(t,2881))},2881:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return Z}});var r=t(7437),i=t(2265),n=t(3379),l=t(5676),s=t(8470),d=t(2020),o=t(5249),u=t(2153),m=t(4782);let c=(0,d.Ue)((0,o.mW)((a,e)=>({setFormData:a=>{let e=new FormData;return e.append("pinjaman_id",a.pinjaman_id),e.append("bukti",a.bukti),e},dtTerimaPinjam:[],showTerimaPinjam:[],setTerimaPinjam:async e=>{let{page:t=1,limit:r=10,search:i,sortby:n,order:l}=e;try{let e=await m.Z.getState().setToken(),s=await (0,u.Sj)({method:"get",url:"/terimaPinjam",headers:{Authorization:"Bearer ".concat(e)},params:{limit:r,page:t,search:i,sortby:n,order:l}});return a(a=>({...a,dtTerimaPinjam:s.data.data})),{status:"berhasil",data:s.data}}catch(a){var s;return{status:"error",error:null===(s=a.response)||void 0===s?void 0:s.data}}},setShowTerimaPinjam:async e=>{try{let t=await m.Z.getState().setToken(),r=await (0,u.Sj)({method:"get",url:"/terimaPinjam/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return console.log({response:r}),a(a=>({...a,showTerimaPinjam:r.data.data})),{status:"berhasil",data:r.data}}catch(a){var t;return{status:"error",error:null===(t=a.response)||void 0===t?void 0:t.data}}},addData:async t=>{let r=(null==t?void 0:t.bukti)?e().setFormData(t):t;try{let e=await m.Z.getState().setToken(),t=await (0,u.Sj)({method:"post",url:"/terimaPinjam",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"},data:r});return a(a=>({dtTerimaPinjam:{last_page:a.dtTerimaPinjam.last_page,current_page:a.dtTerimaPinjam.current_page,data:[t.data.data,...a.dtTerimaPinjam.data]}})),{status:"berhasil tambah",data:t.data}}catch(a){return{status:"error",data:a.response.data}}},removeData:async e=>{try{let t=await m.Z.getState().setToken(),r=await (0,u.Sj)({method:"delete",url:"/terimaPinjam/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return a(a=>({dtTerimaPinjam:{last_page:a.dtTerimaPinjam.last_page,current_page:a.dtTerimaPinjam.current_page,data:a.dtTerimaPinjam.data.filter(a=>a.id!==e)}})),{status:"berhasil hapus",data:r.data}}catch(a){return{status:"error",data:a.response.data}}},updateData:async(t,r)=>{delete r.id;let i=(null==r?void 0:r.bukti)?e().setFormData(r):r,n=await m.Z.getState().setToken();try{let e=await (0,u.Sj)({url:"/terimaPinjam/".concat(t),method:"post",headers:(null==r?void 0:r.bukti)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(n)}:{Authorization:"Bearer ".concat(n)},data:i,params:{_method:"PUT"}});return a(a=>({dtTerimaPinjam:{last_page:a.dtTerimaPinjam.last_page,current_page:a.dtTerimaPinjam.current_page,data:a.dtTerimaPinjam.data.map(a=>a.id===t?{...a,...e.data.data}:a)}})),{status:"berhasil update",data:e.data}}catch(a){return{status:"error",data:a.response.data}}}})));var h=a=>{let{setDelete:e,setEdit:t,search:d}=a,{setTerimaPinjam:o,dtTerimaPinjam:u}=c(),[m,h]=(0,i.useState)(1),[j,p]=(0,i.useState)(10),[g,x]=(0,i.useState)(!0),[v,f]=(0,i.useState)(!1),[b,w]=(0,i.useState)(),y=async()=>{await o({page:m,limit:j,search:d}),x(!1)};return(0,i.useEffect)(()=>(y(),()=>{}),[m,j]),(0,i.useEffect)(()=>{h(1),y()},[d]),(0,r.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:g?(0,r.jsx)(n.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)(s.Z,{headTable:["No","Nama","Tgl. Pinjam","Bukti","Aksi"],tableBodies:["pinjaman.anggota.nm_anggota","pinjaman.tgl_pinjam","bukti"],dataTable:u.data,page:m,limit:j,setEdit:t,setDelete:e,ubah:!0,hapus:!0})}),(null==u?void 0:u.last_page)>1&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(l.Z,{currentPage:null==u?void 0:u.current_page,totalPages:null==u?void 0:u.last_page,setPage:h})})]})})},j=t(8224),p=t(6628),g=t(8658),x=t(2670),v=t(2820),f=t(1822),b=a=>{let{dataDb:e,body:t,control:i,required:n,name:l,errors:s,placeholder:d,addClass:o,label:u,defaultOptions:m=!0}=a,c={multiValue:(a,e)=>e.data.isFixed?{...a,backgroundColor:"gray"}:a,multiValueLabel:(a,e)=>e.data.isFixed?{...a,fontWeight:"bold",color:"white",paddingRight:6}:a,multiValueRemove:(a,e)=>e.data.isFixed?{...a,display:"none"}:a},h=(a,e)=>{let t=a[e];if("id"===e)return{value:t,label:""};if(!e.includes("."))return{value:"",label:t};{let[t,...r]=e.split(".");return h(a[t],r.join("."))}},j=()=>e&&e.map((a,e)=>{let r=t.map(e=>h(a,e)),i=r.map(a=>a.label).filter(a=>""!==a),n=i.join(i.length>1?" - ":"");return{value:r.find(a=>""!==a.value).value,label:n}}),p=a=>{var e;return null===(e=j())||void 0===e?void 0:e.filter(e=>e.label.toLowerCase().includes(a.toLowerCase()))},g=(a,e)=>{setTimeout(()=>{e(p(a))},1e3)};return(0,r.jsxs)("div",{className:o,children:[u&&(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:u}),n&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,r.jsx)(x.Qr,{name:l,control:i,rules:{required:n},render:a=>{var e;let{field:{onChange:t,value:i,ref:n}}=a;return(0,r.jsx)(f.Z,{cacheOptions:!0,defaultOptions:m,isClearable:!0,isSearchable:!0,loadOptions:g,placeholder:d,menuPlacement:"auto",menuPosition:"fixed",styles:c,ref:n,value:(null===(e=j())||void 0===e?void 0:e.find(a=>a.value===i))||null,onChange:a=>t(a?a.value:a)})}}),(null==s?void 0:s.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[u," tidak boleh kosong"]})]})};let w=(0,d.Ue)((0,o.mW)((a,e)=>({dtPinjaman:[],setPinjaman:async e=>{let{page:t=1,limit:r=10,search:i}=e;try{let e=await (0,u.hi)({method:"get",url:"/pinjaman",params:{limit:r,page:t,search:i}});return a(a=>({...a,dtPinjaman:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setPinjamanAll:async e=>{let{search:t}=e;try{let e=await (0,u.hi)({method:"get",url:"/pinjaman/all",params:{search:t}});return a(a=>({...a,dtPinjaman:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setPinjamanStatus:async e=>{let{page:t=1,limit:r=10,search:i,status:n="terima"}=e;try{let e=await (0,u.hi)({method:"get",url:"/pinjaman/status",params:{limit:r,page:t,search:i,status:n}});return a(a=>({...a,dtPinjaman:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}}})));t(2413);var y=a=>{let{register:e,errors:t,control:n,dtEdit:l,watch:s,setValue:d,showModal:o,myFile:u,setMyFile:m}=a,{setPinjamanStatus:c,dtPinjaman:h}=w(),j=async()=>await c({search:""});return(0,i.useEffect)(()=>(j(),()=>{}),[o]),(0,r.jsxs)(r.Fragment,{children:[(null==h?void 0:h.data)&&(0,r.jsx)(b,{label:"Pinjaman",placeholder:"Pilih Pinjaman",name:"pinjaman_id",dataDb:null==h?void 0:h.data,body:["id","tgl_pinjam","anggota.nm_anggota"],control:n,required:!0,errors:t.pinjaman_id,addClass:"col-span-4"}),(0,r.jsx)(v.Z,{label:"Bukti",name:"bukti",register:e,accept:"image/*",required:!0,errors:t.bukti,addClass:"col-span-4",setValue:d,fileEdit:null==l?void 0:l.bukti,myFile:u,setMyFile:m})]})},P=t(1262),k=t(1023),S=a=>{let{showModal:e,setShowModal:t,dtEdit:l}=a,[s,d]=(0,i.useState)(),[o,u]=(0,i.useState)(!1),{addData:m,updateData:h}=c(),{register:v,handleSubmit:f,setValue:b,control:w,formState:{errors:S},watch:_}=(0,x.cI)(),T=()=>{b("id",""),b("pinjaman_id",""),b("bukti",""),d(null)};(0,i.useEffect)(()=>{l?(b("id",l.id),b("pinjaman_id",l.pinjaman_id),b("bukti",l.bukti),d(l.bukti)):T()},[e,l]);let N=async a=>{console.log({row:a}),(0,k.Z)({row:a,dtEdit:l,setIsLoading:u,setShowModal:t,addData:m,updateData:h,resetForm:T,toastShow:g.Z})};return(0,r.jsx)(p.Z,{title:"Form Dosen",showModal:e,setShowModal:t,children:(0,r.jsxs)("form",{onSubmit:f(N),children:[(0,r.jsx)(j.Z,{name:"id",register:v,type:"hidden"}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,r.jsx)(y,{register:v,errors:S,dtEdit:l,control:w,watch:_,setValue:b,showModal:e,myFile:s,setMyFile:d})}),(0,r.jsx)("div",{children:o?(0,r.jsx)(n.Z,{}):(0,r.jsx)(P.Z,{onClick:f(N),children:"Simpan"})})]})})},_=t(6533),T=t(8009),N=t(7500),Z=()=>{let{removeData:a}=c(),[e,t]=(0,i.useState)(!1),[n,l]=(0,i.useState)(!1),[s,d]=(0,i.useState)(),[o,u]=(0,i.useState)(),[m,j]=(0,i.useState)(""),p=async e=>{let{id:t,isDelete:r}=e;if(d(t),r){let{data:e}=await a(s);(0,g.Z)({event:e}),l(!1)}else l(!0)};return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(T.x7,{}),(0,r.jsx)(S,{dtEdit:o,showModal:e,setShowModal:t}),(0,r.jsx)(_.Z,{showDel:n,setShowDel:l,setDelete:p}),(0,r.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,r.jsx)("p",{children:"Silahkan Mengolah data TerimaPinjam"}),(0,r.jsx)("div",{children:(0,r.jsx)(P.Z,{onClick:()=>{t(!0),u(null)},children:"Tambah Data"})})]}),(0,r.jsx)(N.Z,{placeholder:"Cari Data",onChange:a=>j(a)})]}),(0,r.jsx)(h,{setDelete:p,setEdit:a=>{t(!0),u(a)},search:m})]})}},2820:function(a,e,t){"use strict";var r=t(7437),i=t(2153),n=t(703),l=t(2265),s=t(1590),d=t.n(s);e.Z=a=>{let{label:e,register:t,required:s,name:o,errors:u,addClass:m,accept:c,setValue:h,fileEdit:j,myFile:p,setMyFile:g}=a,[x,v]=(0,l.useState)(),f=a=>new Promise(()=>{if(a){var e;let t=(null==a?void 0:null===(e=a.type)||void 0===e?void 0:e.split("/"))||[];if("image"!==t[0])return b(a);console.log({splitType:t}),d().imageFileResizer(a,1500,1500,t[1],80,0,a=>{b(a)},"file")}else b(null)}),b=a=>{var e;if(a){let e=new FileReader;e.readAsDataURL(a),e.onloadend=()=>{g(e.result)}}v(((null==a?void 0:null===(e=a.type)||void 0===e?void 0:e.split("/"))||[])[0]),h(o,a)};return(0,r.jsxs)("div",{className:m,children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:e}),s&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,r.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:c,onChange:a=>{var e;f((null===(e=a.target)||void 0===e?void 0:e.files[0])||null)}}),(0,r.jsx)("input",{type:"hidden",id:e,...t(o,{required:s})}),(0,r.jsxs)("div",{className:"flex gap-4 mt-2",children:[p&&"image"===x&&(0,r.jsx)(n.default,{className:"rounded-lg",src:p,width:100,height:100,alt:""}),j&&"file"!==o&&(0,r.jsx)("div",{children:(0,r.jsx)(n.default,{src:"".concat(i._n,"/").concat(j),width:100,height:100,alt:""})})]}),(null==u?void 0:u.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[e," tidak boleh kosong"]})]})}}},function(a){a.O(0,[779,990,910,656,703,680,426,397,973,971,69,744],function(){return a(a.s=9862)}),_N_E=a.O()}]);